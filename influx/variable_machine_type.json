[
  {
    "apiVersion": "influxdata.com/v2alpha1",
    "kind": "Variable",
    "metadata": {
      "name": "variable-sensors-machine-type"
    },
    "spec": {
      "language": "flux",
      "name": "machine_type",
      "query": "import \"strings\"\r\n\r\nfrom(bucket: \"sensors\")\r\n    |> range(start: -30d)\r\n    |> filter(fn: (r) => r[\"_measurement\"] == \"sensor\")\r\n    |> filter(fn: (r) => r[\"_field\"] != \"anomaly\")\r\n    |> group(columns: [\"topic\"])\r\n    |> distinct(column: \"topic\")\r\n    |> map(fn: (r) => ({r with _value: strings.split(v:r._value,t:\"/\")[2]}))\r\n    |> keep(columns: [\"_value\"])",
      "selected": [
        "blade"
      ],
      "type": "query"
    }
  }
]